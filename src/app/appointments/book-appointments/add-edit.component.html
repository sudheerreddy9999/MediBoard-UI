<div
  class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50"
>
  <div
    class="bg-white dark:bg-neutral-950 relative rounded-lg shadow-2xl w-full max-w-[55%] h-[510px] ml-4 md:mx-0 pl-6 space-y-6 bg-custom"
  >
    <div class="relative z-10">
      <div class="text-center flex ml-[38%]">
        <p class="text-[18px] font-bold text-black py-4">Book An Appointment</p>
        <mat-icon
          class="ml-[52%] text-black text-2xl mt-2 mr-4 my-4"
          (click)="handleCloseModel()"
          >close</mat-icon
        >
      </div>
      <form
        [formGroup]="AppointmentData"
        (ngSubmit)="onSubmit()"
        class="space-y-2"
      >
        <div class="grid grid-cols-2 gap-4">
          <!-- Left Column -->
          <div>
            <div class="flex">
              <div class="w-1/2 mx-1">
                <label class="block text-xs mb-1 text-black">First Name</label>
                <div
                  class="flex items-center bg-white rounded-lg border border-gray-300 px-2 py-1"
                >
                  <mat-icon class="mr-2 text-black text-sm">person</mat-icon>
                  <input
                    type="text"
                    formControlName="patient_firstname"
                    class="w-full text-xs bg-transparent focus:outline-none text-black placeholder-black"
                    placeholder="Enter First Name"
                  />
                </div>
                <!-- Validation Errors -->
                <div
                  *ngIf="
                    AppointmentData.get('patient_firstname')?.touched &&
                    AppointmentData.get('patient_firstname')?.invalid
                  "
                >
                  <small
                    *ngIf="AppointmentData.get('patient_firstname')?.errors?.['required']"
                    class="text-red-600"
                  >
                    First Name is required.
                  </small>
                  <small
                    *ngIf="AppointmentData.get('patient_firstname')?.errors?.['minlength']"
                    class="text-red-600"
                  >
                    Must be at least 2 characters long.
                  </small>
                  <small
                    *ngIf="AppointmentData.get('patient_firstname')?.errors?.['pattern']"
                    class="text-red-600"
                  >
                    Only letters and spaces allowed.
                  </small>
                </div>
              </div>
              <div class="w-1/2">
                <label class="block text-xs mb-1 text-black">Last Name</label>
                <div
                  class="flex items-center bg-white rounded-lg border border-gray-300 px-2 py-1"
                >
                  <mat-icon class="mr-2 text-black text-sm">person</mat-icon>
                  <input
                    type="text"
                    formControlName="patient_lastname"
                    class="w-full text-xs bg-transparent focus:outline-none text-black placeholder-black"
                    placeholder="Enter Last Name"
                  />
                </div>
              </div>
            </div>

            <div class="w-full mx-1 mt-4">
              <label class="block text-xs mb-1 text-black"
                >Enter Phone Number</label
              >
              <div
                class="flex items-center bg-white rounded-lg border border-gray-300 px-2 py-1"
              >
                <mat-icon class="mr-2 text-black text-sm">call</mat-icon>
                <input
                  type="text"
                  formControlName="mobile_number"
                  class="w-full text-xs bg-transparent focus:outline-none text-black placeholder-black"
                  placeholder="Enter Phone Number"
                />
              </div>
            </div>

            <div class="w-full mx-1 mt-4">
              <label class="block text-xs mb-1 text-black">Enter Email</label>
              <div
                class="flex items-center bg-white rounded-lg border border-gray-300 px-2 py-1"
              >
                <mat-icon class="mr-2 text-black text-sm">mail</mat-icon>
                <input
                  type="text"
                  formControlName="patientEmail"
                  class="w-full text-xs text-black bg-transparent focus:outline-none placeholder-black"
                  placeholder="Enter Email"
                />
              </div>
            </div>

            <div class="w-full mx-1 mt-4">
              <label class="block text-xs mb-1 text-black"
                >Select Birth Date</label
              >
              <div
                class="flex items-center bg-white rounded-lg border border-gray-300 px-2 py-1"
              >
                <mat-icon class="mr-2 text-black text-sm"
                  >calendar_month</mat-icon
                >
                <input
                  type="date"
                  class="w-full text-xs bg-transparent focus:outline-none text-black placeholder-black"
                  placeholder="Enter Birth Date"
                />
              </div>
            </div>

            <div class="w-full mx-1 mt-4">
              <label class="block text-xs mb-1 text-black"
                >Find the Right Doctor for Your Concern</label
              >
              <div
                class="flex items-center bg-white rounded-lg border border-gray-300"
              >
                <mat-icon class="mx-3 text-black text-sm">search</mat-icon>
                <input
                  type="text"
                  name="searchContent"
                  formControlName="find_doctor"
                  placeholder="Find Your Doctor"
                  class="w-full text-xs bg-transparent focus:outline-none text-black placeholder-black"
                />
                <button
                  class="bg-[#6e81c7] text-xs py-2 px-4 rounded-lg rounded-l-none text-white shadow"
                  (click)="openDoctorsModal()"
                  type="button"
                >
                  Search
                </button>
              </div>
            </div>
            <!-- Doctor Name Input -->
            <div class="w-full mx-1 mt-4">
              <label class="block text-sm mb-1 text-black">Doctor Name</label>
              <div
                class="flex items-center bg-white rounded-lg border border-gray-300 px-2 py-[6px] w-full"
              >
                <mat-icon class="mr-2 text-black text-sm">token</mat-icon>
                <select
                  id="doctorName"
                  name="doctorName"
                  formControlName="doctor_name"
                  (change)="onDoctorChange($event)"
                  class="text-xs w-full border-none outline-none select-hidden"
                >
                  <option
                    *ngFor="let doctor of doctorsData"
                    [value]="doctor.name"
                    class="text-sm"
                  >
                    {{ doctor.name }} ,{{ doctor.specialization }}
                  </option>
                </select>
              </div>
              <div
                *ngIf="
                  AppointmentData.get('doctor_name')?.touched &&
                  AppointmentData.get('doctor_name')?.invalid
                "
              >
                <small
                  *ngIf="AppointmentData.get('doctor_name')?.errors?.['required']"
                  class="text-red-600"
                  >Doctor Name is required.</small
                >
              </div>
            </div>

            <div
              *ngIf="
                AppointmentData.get('doctor_name')?.touched &&
                AppointmentData.get('doctor_name')?.invalid
              "
            ></div>
          </div>

          <!-- Right Column -->
          <div mt-4>
            <label class="block text-xs font-medium text-black mb-1 pt-4 ml-4"
              >Select Appointment Date</label
            >
            <div class="main-container">
              <p-calendar
                [styleClass]="'custom-height'"
                class="small-calendar text-xs"
                formControlName="appointmentDate"
                (ngModelChange)="onDateChange($event)"
                [inline]="true"
                [showWeek]="true"
                [minDate]="today"
              ></p-calendar>
            </div>
            <div class="flex flex-wrap justify-center gap-2 my-1">
              <div
                *ngFor="let slot of currentDayDoctorSlots"
                class="flex items-center"
              >
                <button
                  type="button"
                  class="p-2 shadow-lg rounded-lg text-xs"
                  [ngClass]="{
                    'bg-blue-500': userSelectedSlot === slot.slot_id
                  }"
                  (click)="selectTimeSlotIf(slot.slot_id)"
                >
                  {{ slot.slot_time | timeFormat }} -
                  {{ slot.slot_end_time | timeFormat }}
                </button>
              </div>
            </div>
            <!-- Buttons -->
            <div class="flex justify-end items-end pr-4 pb-2">
              <button
                type="submit"
                class="px-3 py-3 pr-4 bg-[#6e81c7] rounded-full text-xs font-normal text-white shadow-lg"
              >
                Book Appointment
              </button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<div
  class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50"
  *ngIf="issearchDoctor"
>
  <div
    class="bg-white dark:bg-neutral-950 relative shadow-2xl w-full h-screen p-8"
  >
    <app-display-doctors
      (doctorInfo)="handleAppointmentData($event)"
      [enableCloseButton]="true"
      buttonMessage="Select Doctor"
      (closeDoctorsSearch)="handelDoctorsClose($event)"
    ></app-display-doctors>
  </div>
</div>
<app-loader
  *ngIf="openLoader"
  message="Loading data, please wait..."
></app-loader>
<app-modal
  *ngIf="openModalComponnet"
  [message]="modalMessage"
  [typeOfModal]="typeOfModal"
  (closeModalEmit)="handleCloseEmitModal($event)"
></app-modal>
